---
import type { Slide } from '@/types/Slide';
import updatePath from '@/libs/updatePath';

interface Props {
  items: Slide[];
}

const { items } = Astro.props;
---

<div class="swiper md:aspect-video h-full">
  <div class="swiper-wrapper">
    {
      items.map(item => (
        <div class="swiper-slide">
          {item.type === 'video' ? (
            <video controls autoplay muted loop>
              <source
                src={updatePath(item.src.pc)}
                type="video/mp4"
                media="(min-width: 768px)"
              />
              <source
                src={updatePath(item.src.sp || item.src.pc)}
                type="video/mp4"
              />
            </video>
          ) : (
            <picture>
              <source srcset={item.src.pc} media="(min-width: 768px)" />
              <img src={item.src.sp || item.src.pc} alt={item.alt} />
            </picture>
          )}
        </div>
      ))
    }
  </div>
</div>

<script>
  import slider from './slider';
  slider();
</script>

<style lang="scss">
  .swiper {
    width: 100%;

    &-slide {
      opacity: 0;
      visibility: hidden;
      &-active {
        opacity: 1;
        visibility: visible;

        img,
        video {
          width: 100%;
          height: 100%;
          object-fit: cover;
        }
      }
    }
  }
</style>
